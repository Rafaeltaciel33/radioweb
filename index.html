<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Meu Projeto Firebase</title>
  <script type="module">
    // Importa módulos do Firebase (v9+ modular SDK)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics.js";
    import { getFirestore, collection, addDoc, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    // Configuração do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyB2-S4zYL2eU_GwPoyUwXeZLXUPdpzAzVM",
      authDomain: "amordeus-ae3d6.firebaseapp.com",
      projectId: "amordeus-ae3d6",
      storageBucket: "amordeus-ae3d6.firebasestorage.app",
      messagingSenderId: "1007935161262",
      appId: "1:1007935161262:web:14a572f7c4729cfbbc3e3f",
      measurementId: "G-2QQSBLDKED"
    };

    // Inicializa app Firebase e Analytics
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

    // Firestore
    const db = getFirestore(app);

    // Função para enviar uma mensagem
    async function enviarMensagem(texto) {
      try {
        await addDoc(collection(db, "chat-messages"), {
          text: texto,
          timestamp: Date.now()
        });
      } catch (e) {
        console.error("Erro ao enviar mensagem:", e);
      }
    }

    // Escuta mensagens em tempo real
    const q = query(collection(db, "chat-messages"), orderBy("timestamp"));
    onSnapshot(q, (querySnapshot) => {
      const messagesDiv = document.getElementById("messages");
      messagesDiv.innerHTML = "";
      querySnapshot.forEach((doc) => {
        const msg = doc.data();
        const div = document.createElement("div");
        div.textContent = msg.text;
        div.className = "mb-2 p-2 bg-red-100 rounded";
        messagesDiv.appendChild(div);
      });
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    });

    // Event listener para o botão enviar
    window.onload = () => {
      const sendBtn = document.getElementById("send-btn");
      const input = document.getElementById("message-input");

      sendBtn.addEventListener("click", () => {
        const text = input.value.trim();
        if (text !== "") {
          enviarMensagem(text);
          input.value = "";
        }
      });

      input.addEventListener("keypress", (e) => {
        if (e.key === "Enter") {
          sendBtn.click();
        }
      });
    };
  </script>
  <style>
    body {
      font-family: 'Montserrat', sans-serif;
    }
  </style>
</head>
<body>
  <div id="messages" style="height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px;"></div>
  <input id="message-input" type="text" placeholder="Digite sua mensagem..." style="width: 100%; padding: 10px; margin-top: 10px;">
  <button id="send-btn" style="width: 100%; padding: 10px; margin-top: 5px; background-color: #dc2626; color: white; border: none; font-weight: bold;">Enviar</button>
</body>
</html>
